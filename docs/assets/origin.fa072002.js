import*as e from"https://cdn.skypack.dev/three@0.130.1";import t from"https://cdn.skypack.dev/three@0.130.1/examples/jsm/libs/stats.module.js";import{GUI as n}from"https://cdn.skypack.dev/three@0.130.1/examples/jsm/libs/dat.gui.module.js";import{OrbitControls as o}from"https://cdn.skypack.dev/three@0.130.1/examples/jsm/controls/OrbitControls.js";import{GLTFLoader as s}from"https://cdn.skypack.dev/three@0.130.1/examples/jsm/loaders/GLTFLoader.js";import{openBlock as r,createBlock as i}from"https://unpkg.com/vue@3.0.11/dist/vue.runtime.esm-browser.prod.js";function c(e,t){const n=Object.create(null),o=e.split(",");for(let s=0;s<o.length;s++)n[o[s]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}const a=c("Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt"),l={},u=()=>{},f=Object.assign,d=Object.prototype.hasOwnProperty,p=(e,t)=>d.call(e,t),h=Array.isArray,g=e=>"[object Map]"===b(e),w=e=>"function"==typeof e,m=e=>"string"==typeof e,v=e=>"symbol"==typeof e,_=e=>null!==e&&"object"==typeof e,y=Object.prototype.toString,b=e=>y.call(e),x=e=>m(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,S=(e,t)=>e!==t&&(e==e||t==t),E=new WeakMap,k=[];let R;const j=Symbol(""),C=Symbol("");function M(e,t=l){(function(e){return e&&!0===e._isEffect})(e)&&(e=e.raw);const n=function(e,t){const n=function(){if(!n.active)return t.scheduler?void 0:e();if(!k.includes(n)){A(n);try{return W.push(P),P=!0,k.push(n),R=n,e()}finally{k.pop(),I(),R=k[k.length-1]}}};return n.id=O++,n.allowRecurse=!!t.allowRecurse,n._isEffect=!0,n.active=!0,n.raw=e,n.deps=[],n.options=t,n}(e,t);return t.lazy||n(),n}let O=0;function A(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let P=!0;const W=[];function $(){W.push(P),P=!1}function I(){const e=W.pop();P=void 0===e||e}function L(e,t,n){if(!P||void 0===R)return;let o=E.get(e);o||E.set(e,o=new Map);let s=o.get(n);s||o.set(n,s=new Set),s.has(R)||(s.add(R),R.deps.push(s))}function N(e,t,n,o,s,r){const i=E.get(e);if(!i)return;const c=new Set,a=e=>{e&&e.forEach((e=>{(e!==R||e.allowRecurse)&&c.add(e)}))};if("clear"===t)i.forEach(a);else if("length"===n&&h(e))i.forEach(((e,t)=>{("length"===t||t>=o)&&a(e)}));else switch(void 0!==n&&a(i.get(n)),t){case"add":h(e)?x(n)&&a(i.get("length")):(a(i.get(j)),g(e)&&a(i.get(C)));break;case"delete":h(e)||(a(i.get(j)),g(e)&&a(i.get(C)));break;case"set":g(e)&&a(i.get(j))}c.forEach((e=>{e.options.scheduler?e.options.scheduler(e):e()}))}const z=c("__proto__,__v_isRef,__isVue"),F=new Set(Object.getOwnPropertyNames(Symbol).map((e=>Symbol[e])).filter(v)),U=D(),T=D(!1,!0),B=D(!0),H=D(!0,!0),G={};function D(e=!1,t=!1){return function(n,o,s){if("__v_isReactive"===o)return!e;if("__v_isReadonly"===o)return e;if("__v_raw"===o&&s===(e?t?_e:ve:t?me:we).get(n))return n;const r=h(n);if(!e&&r&&p(G,o))return Reflect.get(G,o,s);const i=Reflect.get(n,o,s);if(v(o)?F.has(o):z(o))return i;if(e||L(n,0,o),t)return i;if(Re(i)){return!r||!x(o)?i.value:i}return _(i)?e?xe(i):be(i):i}}["includes","indexOf","lastIndexOf"].forEach((e=>{const t=Array.prototype[e];G[e]=function(...e){const n=ke(this);for(let t=0,s=this.length;t<s;t++)L(n,0,t+"");const o=t.apply(n,e);return-1===o||!1===o?t.apply(n,e.map(ke)):o}})),["push","pop","shift","unshift","splice"].forEach((e=>{const t=Array.prototype[e];G[e]=function(...e){$();const n=t.apply(this,e);return I(),n}}));function K(e=!1){return function(t,n,o,s){let r=t[n];if(!e&&(o=ke(o),r=ke(r),!h(t)&&Re(r)&&!Re(o)))return r.value=o,!0;const i=h(t)&&x(n)?Number(n)<t.length:p(t,n),c=Reflect.set(t,n,o,s);return t===ke(s)&&(i?S(o,r)&&N(t,"set",n,o):N(t,"add",n,o)),c}}const q={get:U,set:K(),deleteProperty:function(e,t){const n=p(e,t);e[t];const o=Reflect.deleteProperty(e,t);return o&&n&&N(e,"delete",t,void 0),o},has:function(e,t){const n=Reflect.has(e,t);return v(t)&&F.has(t)||L(e,0,t),n},ownKeys:function(e){return L(e,0,h(e)?"length":j),Reflect.ownKeys(e)}},J={get:B,set:(e,t)=>!0,deleteProperty:(e,t)=>!0};f({},q,{get:T,set:K(!0)}),f({},J,{get:H});const V=e=>_(e)?be(e):e,X=e=>_(e)?xe(e):e,Z=e=>e,Q=e=>Reflect.getPrototypeOf(e);function Y(e,t,n=!1,o=!1){const s=ke(e=e.__v_raw),r=ke(t);t!==r&&!n&&L(s,0,t),!n&&L(s,0,r);const{has:i}=Q(s),c=o?Z:n?X:V;return i.call(s,t)?c(e.get(t)):i.call(s,r)?c(e.get(r)):void 0}function ee(e,t=!1){const n=this.__v_raw,o=ke(n),s=ke(e);return e!==s&&!t&&L(o,0,e),!t&&L(o,0,s),e===s?n.has(e):n.has(e)||n.has(s)}function te(e,t=!1){return e=e.__v_raw,!t&&L(ke(e),0,j),Reflect.get(e,"size",e)}function ne(e){e=ke(e);const t=ke(this);return Q(t).has.call(t,e)||(t.add(e),N(t,"add",e,e)),this}function oe(e,t){t=ke(t);const n=ke(this),{has:o,get:s}=Q(n);let r=o.call(n,e);r||(e=ke(e),r=o.call(n,e));const i=s.call(n,e);return n.set(e,t),r?S(t,i)&&N(n,"set",e,t):N(n,"add",e,t),this}function se(e){const t=ke(this),{has:n,get:o}=Q(t);let s=n.call(t,e);s||(e=ke(e),s=n.call(t,e)),o&&o.call(t,e);const r=t.delete(e);return s&&N(t,"delete",e,void 0),r}function re(){const e=ke(this),t=0!==e.size,n=e.clear();return t&&N(e,"clear",void 0,void 0),n}function ie(e,t){return function(n,o){const s=this,r=s.__v_raw,i=ke(r),c=t?Z:e?X:V;return!e&&L(i,0,j),r.forEach(((e,t)=>n.call(o,c(e),c(t),s)))}}function ce(e,t,n){return function(...o){const s=this.__v_raw,r=ke(s),i=g(r),c="entries"===e||e===Symbol.iterator&&i,a="keys"===e&&i,l=s[e](...o),u=n?Z:t?X:V;return!t&&L(r,0,a?C:j),{next(){const{value:e,done:t}=l.next();return t?{value:e,done:t}:{value:c?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}function ae(e){return function(...t){return"delete"!==e&&this}}const le={get(e){return Y(this,e)},get size(){return te(this)},has:ee,add:ne,set:oe,delete:se,clear:re,forEach:ie(!1,!1)},ue={get(e){return Y(this,e,!1,!0)},get size(){return te(this)},has:ee,add:ne,set:oe,delete:se,clear:re,forEach:ie(!1,!0)},fe={get(e){return Y(this,e,!0)},get size(){return te(this,!0)},has(e){return ee.call(this,e,!0)},add:ae("add"),set:ae("set"),delete:ae("delete"),clear:ae("clear"),forEach:ie(!0,!1)},de={get(e){return Y(this,e,!0,!0)},get size(){return te(this,!0)},has(e){return ee.call(this,e,!0)},add:ae("add"),set:ae("set"),delete:ae("delete"),clear:ae("clear"),forEach:ie(!0,!0)};function pe(e,t){const n=t?e?de:ue:e?fe:le;return(t,o,s)=>"__v_isReactive"===o?!e:"__v_isReadonly"===o?e:"__v_raw"===o?t:Reflect.get(p(n,o)&&o in t?n:t,o,s)}["keys","values","entries",Symbol.iterator].forEach((e=>{le[e]=ce(e,!1,!1),fe[e]=ce(e,!0,!1),ue[e]=ce(e,!1,!0),de[e]=ce(e,!0,!0)}));const he={get:pe(!1,!1)},ge={get:pe(!0,!1)},we=new WeakMap,me=new WeakMap,ve=new WeakMap,_e=new WeakMap;function ye(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((e=>b(e).slice(8,-1))(e))}function be(e){return e&&e.__v_isReadonly?e:Se(e,!1,q,he,we)}function xe(e){return Se(e,!0,J,ge,ve)}function Se(e,t,n,o,s){if(!_(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const r=s.get(e);if(r)return r;const i=ye(e);if(0===i)return e;const c=new Proxy(e,2===i?o:n);return s.set(e,c),c}function Ee(e){return function(e){return!(!e||!e.__v_isReadonly)}(e)?Ee(e.__v_raw):!(!e||!e.__v_isReactive)}function ke(e){return e&&ke(e.__v_raw)||e}function Re(e){return Boolean(e&&!0===e.__v_isRef)}function je(e,t,n,o){let s;try{s=o?e(...o):e()}catch(r){Me(r,t,n)}return s}function Ce(e,t,n,o){if(w(e)){const r=je(e,t,n,o);return r&&(_(s=r)&&w(s.then)&&w(s.catch))&&r.catch((e=>{Me(e,t,n)})),r}var s;const r=[];for(let i=0;i<e.length;i++)r.push(Ce(e[i],t,n,o));return r}function Me(e,t,n,o=!0){t&&t.vnode;if(t){let o=t.parent;const s=t.proxy,r=n;for(;o;){const t=o.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,s,r))return;o=o.parent}const i=t.appContext.config.errorHandler;if(i)return void je(i,null,10,[e,s,r])}!function(e,t,n,o=!0){console.error(e)}(e,0,0,o)}let Oe=!1,Ae=!1;const Pe=[];let We=0;const $e=[];let Ie=null,Le=0;const Ne=[];let ze=null,Fe=0;const Ue=Promise.resolve();let Te=null,Be=null;function He(e){const t=Te||Ue;return e?t.then(this?e.bind(this):e):t}function Ge(e){if(!(Pe.length&&Pe.includes(e,Oe&&e.allowRecurse?We+1:We)||e===Be)){const t=function(e){let t=We+1,n=Pe.length;const o=Je(e);for(;t<n;){const e=t+n>>>1;Je(Pe[e])<o?t=e+1:n=e}return t}(e);t>-1?Pe.splice(t,0,e):Pe.push(e),De()}}function De(){Oe||Ae||(Ae=!0,Te=Ue.then(Ve))}function Ke(e,t,n,o){h(e)?n.push(...e):t&&t.includes(e,e.allowRecurse?o+1:o)||n.push(e),De()}function qe(e,t=null){if($e.length){for(Be=t,Ie=[...new Set($e)],$e.length=0,Le=0;Le<Ie.length;Le++)Ie[Le]();Ie=null,Le=0,Be=null,qe(e,t)}}const Je=e=>null==e.id?1/0:e.id;function Ve(e){Ae=!1,Oe=!0,qe(e),Pe.sort(((e,t)=>Je(e)-Je(t)));try{for(We=0;We<Pe.length;We++){const e=Pe[We];e&&je(e,null,14)}}finally{We=0,Pe.length=0,function(e){if(Ne.length){const e=[...new Set(Ne)];if(Ne.length=0,ze)return void ze.push(...e);for(ze=e,ze.sort(((e,t)=>Je(e)-Je(t))),Fe=0;Fe<ze.length;Fe++)ze[Fe]();ze=null,Fe=0}}(),Oe=!1,Te=null,(Pe.length||Ne.length)&&Ve(e)}}const Xe=(Ze="m",(e,t=ct)=>function(e,t,n=ct,o=!1){if(n){const s=n[e]||(n[e]=[]),r=t.__weh||(t.__weh=(...o)=>{if(n.isUnmounted)return;$(),at(n);const s=Ce(t,n,e,o);return at(null),I(),s});return o?s.unshift(r):s.push(r),r}}(Ze,e,t));var Ze;const Qe={};function Ye(e,t,{immediate:n,deep:o,flush:s,onTrack:r,onTrigger:i}=l,c=ct){let a,f,d=!1;if(Re(e)?(a=()=>e.value,d=!!e._shallow):Ee(e)?(a=()=>e,o=!0):a=h(e)?()=>e.map((e=>Re(e)?e.value:Ee(e)?tt(e):w(e)?je(e,c,2,[c&&c.proxy]):void 0)):w(e)?t?()=>je(e,c,2,[c&&c.proxy]):()=>{if(!c||!c.isUnmounted)return f&&f(),Ce(e,c,3,[p])}:u,t&&o){const e=a;a=()=>tt(e())}let p=e=>{f=_.options.onStop=()=>{je(e,c,4)}},g=h(e)?[]:Qe;const m=()=>{if(_.active)if(t){const e=_();(o||d||S(e,g))&&(f&&f(),Ce(t,c,3,[e,g===Qe?void 0:g,p]),g=e)}else _()};let v;m.allowRecurse=!!t,v="sync"===s?m:"post"===s?()=>nt(m,c&&c.suspense):()=>{!c||c.isMounted?function(e){Ke(e,Ie,$e,Le)}(m):m()};const _=M(a,{lazy:!0,onTrack:r,onTrigger:i,scheduler:v});return function(e,t=ct){t&&(t.effects||(t.effects=[])).push(e)}(_,c),t?n?m():g=_():"post"===s?nt(_,c&&c.suspense):_(),()=>{var e;(e=_).active&&(A(e),e.options.onStop&&e.options.onStop(),e.active=!1),c&&((e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)})(c.effects,_)}}function et(e,t,n){const o=this.proxy;return Ye(m(e)?()=>o[e]:e.bind(o),t.bind(o),n,this)}function tt(e,t=new Set){if(!_(e)||t.has(e))return e;if(t.add(e),Re(e))tt(e.value,t);else if(h(e))for(let n=0;n<e.length;n++)tt(e[n],t);else if("[object Set]"===b(e)||g(e))e.forEach((e=>{tt(e,t)}));else for(const n in e)tt(e[n],t);return e}const nt=function(e,t){t&&t.pendingBranch?h(e)?t.effects.push(...e):t.effects.push(e):Ke(e,ze,Ne,Fe)};function ot(e,t,n){const o=n.appContext.config.optionMergeStrategies,{mixins:s,extends:r}=t;r&&ot(e,r,n),s&&s.forEach((t=>ot(e,t,n)));for(const i in t)o&&p(o,i)?e[i]=o[i](e[i],t[i],n.proxy,i):e[i]=t[i]}const st=e=>e?4&e.vnode.shapeFlag?e.exposed?e.exposed:e.proxy:st(e.parent):null,rt=f(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>st(e.parent),$root:e=>st(e.root),$emit:e=>e.emit,$options:e=>function(e){const t=e.type,{__merged:n,mixins:o,extends:s}=t;if(n)return n;const r=e.appContext.mixins;if(!r.length&&!o&&!s)return t;const i={};return r.forEach((t=>ot(i,t,e))),ot(i,t,e),t.__merged=i}(e),$forceUpdate:e=>()=>Ge(e.update),$nextTick:e=>He.bind(e.proxy),$watch:e=>et.bind(e)}),it={get({_:e},t){const{ctx:n,setupState:o,data:s,props:r,accessCache:i,type:c,appContext:a}=e;if("__v_skip"===t)return!0;let u;if("$"!==t[0]){const c=i[t];if(void 0!==c)switch(c){case 0:return o[t];case 1:return s[t];case 3:return n[t];case 2:return r[t]}else{if(o!==l&&p(o,t))return i[t]=0,o[t];if(s!==l&&p(s,t))return i[t]=1,s[t];if((u=e.propsOptions[0])&&p(u,t))return i[t]=2,r[t];if(n!==l&&p(n,t))return i[t]=3,n[t];i[t]=4}}const f=rt[t];let d,h;return f?("$attrs"===t&&L(e,0,t),f(e)):(d=c.__cssModules)&&(d=d[t])?d:n!==l&&p(n,t)?(i[t]=3,n[t]):(h=a.config.globalProperties,p(h,t)?h[t]:void 0)},set({_:e},t,n){const{data:o,setupState:s,ctx:r}=e;if(s!==l&&p(s,t))s[t]=n;else if(o!==l&&p(o,t))o[t]=n;else if(p(e.props,t))return!1;return("$"!==t[0]||!(t.slice(1)in e))&&(r[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:o,appContext:s,propsOptions:r}},i){let c;return void 0!==n[i]||e!==l&&p(e,i)||t!==l&&p(t,i)||(c=r[0])&&p(c,i)||p(o,i)||p(rt,i)||p(s.config.globalProperties,i)}};f({},it,{get(e,t){if(t!==Symbol.unscopables)return it.get(e,t,e)},has:(e,t)=>"_"!==t[0]&&!a(t)});let ct=null;const at=e=>{ct=e};const lt={setup(){let r,i,c,a,l,u,f,d;const p=[];let h="idle";const g=[],w={idle:{weight:1},walk:{weight:0},run:{weight:0}},m={sneak_pose:{weight:0},sad_pose:{weight:0},agree:{weight:0},headShake:{weight:0}};let v,_;function y(){const y=document.getElementById("container");d=new e.Clock,r=new e.Scene,r.background=new e.Color(10526880),r.fog=new e.Fog(10526880,10,50);const E=new e.HemisphereLight(16777215,4473924);E.position.set(0,20,0),r.add(E);const C=new e.DirectionalLight(16777215);C.position.set(3,10,10),C.castShadow=!0,C.shadow.camera.top=2,C.shadow.camera.bottom=-2,C.shadow.camera.left=-2,C.shadow.camera.right=2,C.shadow.camera.near=.1,C.shadow.camera.far=40,r.add(C);const M=new e.Mesh(new e.PlaneGeometry(100,100),new e.MeshPhongMaterial({color:10066329,depthWrite:!1}));M.rotation.x=-Math.PI/2,M.receiveShadow=!0,r.add(M);(new s).load("/static/Xbot.glb",(function(t){l=t.scene,r.add(l),l.traverse((function(e){e.isMesh&&(e.castShadow=!0)})),u=new e.SkeletonHelper(l),u.visible=!1,r.add(u);const o=t.animations;f=new e.AnimationMixer(l),_=o.length;for(let n=0;n!==_;++n){let t=o[n];const s=t.name;if(w[s]){const e=f.clipAction(t);b(e),w[s].action=e,g.push(e)}else if(m[s]){e.AnimationUtils.makeClipAdditive(t),t.name.endsWith("_pose")&&(t=e.AnimationUtils.subclip(t,t.name,2,3,30));const n=f.clipAction(t);b(n),m[s].action=n,g.push(n)}}!function(){const e=new n({width:310}),t=e.addFolder("Base Actions"),o=e.addFolder("Additive Action Weights"),s=e.addFolder("General Speed");v={"modify time scale":1};const r=["None",...Object.keys(w)];for(let n=0,i=r.length;n!==i;++n){const e=r[n],o=w[e];v[e]=function(){const e=w[h];S(e?e.action:null,o?o.action:null,.35)},p.push(t.add(v,e))}for(const n of Object.keys(m)){const e=m[n];v[n]=e.weight,o.add(v,n,0,1,.01).listen().onChange((function(t){k(e.action,t),e.weight=t}))}s.add(v,"modify time scale",0,1.5,.01).onChange(x),t.open(),o.open(),s.open(),p.forEach((function(e){e.classList1=e.domElement.parentElement.parentElement.classList,e.classList2=e.domElement.previousElementSibling.classList,e.setInactive=function(){e.classList2.add("control-inactive")},e.setActive=function(){e.classList2.remove("control-inactive")};const t=w[e.property];t&&t.weight||e.setInactive()}))}(),j()})),i=new e.WebGLRenderer({antialias:!0}),i.setPixelRatio(window.devicePixelRatio),i.setSize(window.innerWidth,window.innerHeight),i.outputEncoding=e.sRGBEncoding,i.shadowMap.enabled=!0,y.appendChild(i.domElement),c=new e.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,100),c.position.set(-1,2,3);const O=new o(c,i.domElement);O.enablePan=!1,O.enableZoom=!1,O.target.set(0,1,0),O.update(),a=new t,y.appendChild(a.dom),window.addEventListener("resize",R)}function b(e){const t=e.getClip();k(e,(w[t.name]||m[t.name]).weight),e.play()}function x(e){f.timeScale=e}function S(e,t,n){if("idle"!==h&&e&&t?function(e,t,n){function o(s){s.action===e&&(f.removeEventListener("loop",o),E(e,t,n))}f.addEventListener("loop",o)}(e,t,n):E(e,t,n),t){const e=t.getClip();h=e.name}else h="None";p.forEach((function(e){e.property===h?e.setActive():e.setInactive()}))}function E(e,t,n){t?(k(t,1),t.time=0,e?e.crossFadeTo(t,n,!0):t.fadeIn(n)):e.fadeOut(n)}function k(e,t){e.enabled=!0,e.setEffectiveTimeScale(1),e.setEffectiveWeight(t)}function R(){c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)}function j(){requestAnimationFrame(j);for(let t=0;t!==_;++t){const e=g[t],n=e.getClip();(w[n.name]||m[n.name]).weight=e.getEffectiveWeight()}const e=d.getDelta();f.update(e),a.update(),i.render(r,c)}Xe((()=>{y()}))}},ut={id:"container"};lt.render=function(e,t,n,o,s,c){return r(),i("div",ut)};export default lt;
